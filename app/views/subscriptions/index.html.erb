<div class="flex-container" id="<%='existing-user' if @current_user.api_last_run !=nil %>">
  <div class="sidebar flex-container hidden-xs">
    <div class="flex item dash-tab" title="active">
      <%= link_to "#active", data: { toggle: 'tab'  }, role: 'tab', 'aria-controls' => 'active' do %>
        <i class="far fa-credit-card fa-2x"></i>
      <% end %>
    </div>
    <div class="flex item dash-tab" title="inactive">
      <%= link_to "#inactive", data: { toggle: 'tab'  }, role: 'tab', 'aria-controls' => 'inactive' do %>
        <i class="far fa-credit-card fa-2x"></i>
      <% end %>
    </div>
    <div class="flex item dash-tab" title="manage">
      <%= link_to "#manage", data: { toggle: 'tab'  }, role: 'tab', 'aria-controls' => 'manage' do %>
        <i class="far fa-credit-card fa-2x"></i>
      <% end %>
    </div>
  </div>
  <div class="main-content">
    <div class="col-xs-12">
      <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="active">
          <h4 class="dash-title"><strong>My active subscriptions</strong></h4>
          <%= render 'shared/card-col-legend' %>
  <!-- RENDER REAL SUBSCRIPTION CARD HERE -->

  <!-- TEST FAKE CARD TO DELETE -->
          <div class="card-container">
            <div class="card">
              <img class="subscription-logo" src="http://pngimg.com/uploads/mcdonalds/mcdonalds_PNG9.png">
              <div class="card-column subscription-company-name hidden-xs hidden-sm">
                <h3><strong>Macdonalds</strong>
                </h3>
                <p>Food</p>
              </div>
              <div class="card-column cost-column">
                <h4>€12/month <h4>
                <p>€144/y</p>
              </div>
              <div class="card-column next-payment-column hidden-xs hidden-sm">
                <h4>10 days</h4>
                <p>13/09/18</p>
              </div>
              <div class="card-column saving-column hidden-xs">
                <div onclick="myFunction()">
                  <h4>€35/y</h4>
                  <p>See Alternatives</p>
                </div>
              </div>
              <div class="card-column switch-column hidden-xs">
                <style>
                  .toggle.ios, .toggle-on.ios, .toggle-off.ios { border-radius: 20px; }
                  .toggle.ios .toggle-handle { border-radius: 20px; }
                </style>
                <input type="checkbox" checked data-toggle="toggle" data-style="ios">
                <style>
                  .toggle.android { border-radius: 0px;}
                  .toggle.android .toggle-handle { border-radius: 0px; }
                </style>
              </div>
            </div>
            <div id="myDIV" class="card-alternatives-container">
              <div class="card-alternatives">
                <div class="col-xs-12 col-sm-4">
                  <div class="card-each-alternative" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.2)), url('https://upload.wikimedia.org/wikipedia/commons/thumb/3/3a/Burger_King_Logo.svg/2000px-Burger_King_Logo.svg.png');">
                    <div class="card-category">Popular</div>
                    <div class="card-description">
                      <h2>Burger King</h2>
                      <p>Student Deals</p>
                    </div>
                    <img class="card-user" src="">
                    <a class="card-link" href="#" ></a>
                  </div>
                </div>
                <div class="col-xs-12 col-sm-4">
                  <div class="card-each-alternative" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.2)), url('https://i0.wp.com/lovelandmagazine.com/wp-content/uploads/2017/05/Chipotle-feature-w-lines.png?fit=1074%2C438');">
                    <div class="card-category">Popular</div>
                    <div class="card-description">
                      <h2>Le Wagon Shanghai</h2>
                      <p>Very cool city, the best</p>
                    </div>
                    <img class="card-user" src="">
                    <a class="card-link" href="#" ></a>
                  </div>
                </div>
                <div class="col-xs-12 col-sm-4">
                  <div class="card-each-alternative" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.2)), url('http://www.webhostingreviewjam.com/wp-content/uploads/2013/02/cancel-subscription1.png');">
                    <div class="card-category">Popular</div>
                    <div class="card-description">
                      <h2></h2>
                      <p></p>
                    </div>
                    <img class="card-user" src="">
                    <a class="card-link" href="#" ></a>
                  </div>
                </div>
              </div>
            </div>
          </div>
  <!-- END OF TO DELETE? -->

        </div>
        <div role="tabpanel" class="tab-pane" id="inactive">
          <h4 class="dash-title"><strong>My inactive subscriptions</strong></h4>
  <!-- RENDER FOLLOWED SUBSCRIPTION CARDS HERE -->
          <%= render 'shared/card' %>
        </div>
        <div role="tabpanel" class="tab-pane" id="manage">
          <h4 class="dash-title"><strong>Manage my accounts</strong></h4>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
<script src="https://cdn.plaid.com/link/v2/stable/link-initialize.js"></script>
<script>
(function($) {
    var handler = Plaid.create({
        apiVersion: 'v2',
        clientName: 'Plaid Walkthrough Demo',
        env: 'sandbox',
        product: ['transactions'],
        key: '<%= ENV["PLAID_PUBLIC_KEY"] %>',
        onSuccess: function(public_token) {
            $.post('/callback', { public_token: public_token }, function() {
            });
        },
    });

    // if document.querySeletor() != 'undefined'
    document.addEventListener('DOMContentLoaded', function(e) {
      if (document.getElementById('existing-user') == undefined) {
        handler.open();
      }
    });
  })(jQuery);

// on card click, add alternative packages to current subscription
function myFunction() {
  var x = document.getElementById("myDIV");
  if (x.style.display === "none") {
      x.style.display = "block";
  } else {
      x.style.display = "none";
  }
}
</script>


